this is the utility functions of version 1